<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="DBM_Filter - perldoc.perl.org">
    <link rel="icon" href="/public/img/favicon.ico">
    <title>DBM_Filter - perldoc.perl.org</title>
    <link href="/public/css/main.min.css" rel="stylesheet">
    <link href='https://fonts.googleapis.com/css?family=Lato:400,100,300,700,900' rel='stylesheet' type='text/css'>
    <script>
            window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
            ga('create', 'UA-1892152-2', 'auto');  // JJ's account
            ga('create', 'UA-50555-3', 'auto', 'perlOrg');   // perl.org account
            ga('require', 'outboundLinkTracker', {
              events: ['click', 'auxclick', 'contextmenu'],
            });
            ga('require', 'maxScrollTracker');
            ga('send', 'pageview');
            ga('perlOrg.send', 'pageview');
    </script>
    <script async src="https://www.google-analytics.com/analytics.js"></script>
    <script async src="/public/js/tracking.min.js"></script>
  </head>
  <body class="body container-fluid ">
    <div class="wrapper">
        <nav class="navbar navbar-expand-md navbar-dark bg-primary bg-perl fixed-top justify-content-between">
          <a class="navbar-brand" href="/">
            <object class="logo" data="/public/img/logo_perl_doc.svg" type="image/svg+xml" name="Perl Documentation Logo">Perl Documentation Logo</object>
          </a>
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div id="navbar" class="collapse navbar-collapse justify-content-end">
            <ul class="nav navbar-nav navbar-right">
              <li class="nav-item dropdown">
                <a id="navbarDropdown" href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Perl versions</a>
                <div class="dropdown-menu" id="dropdown-menu-links" aria-labelledby="navbarDropdown">
                </div>
              </li>
              <li class="nav-item dropdown">
                <a id="navbarDropdown1" href="#" class="dropdown-toggle nav-link" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Manuals</a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown1">
                  <a class="dropdown-item" href="/5.16.1/index-overview.html">Overview</a>
                  <a class="dropdown-item" href="/5.16.1/index-tutorials.html">Tutorials</a>
                  <a class="dropdown-item" href="/5.16.1/index-faq.html">FAQs</a>
                  <a class="dropdown-item" href="/5.16.1/index-history.html">History / Changes</a>
                  <a class="dropdown-item" href="/5.16.1/index-licence.html">License</a>
                  <a class="dropdown-item" href="/5.16.1/index-language.html">Language</a>
                  <a class="dropdown-item" href="/5.16.1/index-functions.html">Functions</a>
                  <a class="dropdown-item" href="/5.16.1/perlop.html">Operators</a>
                  <a class="dropdown-item" href="/5.16.1/perlvar.html">Special Variables</a>
                  <a class="dropdown-item" href="/5.16.1/index-pragmas.html">Pragmas</a>
                  <a class="dropdown-item" href="/5.16.1/index-utilities.html">Utilities</a>
                  <a class="dropdown-item" href="/5.16.1/index-internals.html">Internals</a>
                  <a class="dropdown-item" href="/5.16.1/index-platforms.html">Platform Specific</a>
                </div>
              </li>
              <li class="nav-item dropdown">
                <a id="navbarDropdown3" href="#" class="nav-link dropdown-toggle " data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Modules</a>
                <div aria-labelledby="navbarDropdown3" class="dropdown-menu letters-wrap">
                  <a class="dropdown-item" href="/5.16.1/index-functions.html">A-Z</a>
                  <a class="dropdown-item" href="/5.16.1/index-functions-by-cat.html">By Category</a>
                  <div class="dropdown-divider"></div>
                  <div class="letter-container">
                    <a class="dropdown-item letters" href="/5.16.1/index-modules-A.html">A</a>
                    <a class="dropdown-item letters" href="/5.16.1/index-modules-B.html">B</a>
                    <a class="dropdown-item letters" href="/5.16.1/index-modules-C.html">C</a>
                    <a class="dropdown-item letters" href="/5.16.1/index-modules-D.html">D</a>
                    <a class="dropdown-item letters" href="/5.16.1/index-modules-E.html">E</a>
                    <a class="dropdown-item letters" href="/5.16.1/index-modules-F.html">F</a>
                    <a class="dropdown-item letters" href="/5.16.1/index-modules-G.html">G</a>
                    <a class="dropdown-item letters" href="/5.16.1/index-modules-H.html">H</a>
                    <a class="dropdown-item letters" href="/5.16.1/index-modules-I.html">I</a>
                    <a class="dropdown-item letters" href="/5.16.1/index-modules-J.html">J</a>
                    <a class="dropdown-item letters" href="/5.16.1/index-modules-L.html">L</a>
                    <a class="dropdown-item letters" href="/5.16.1/index-modules-M.html">M</a>
                    <a class="dropdown-item letters" href="/5.16.1/index-modules-N.html">N</a>
                    <a class="dropdown-item letters" href="/5.16.1/index-modules-O.html">O</a>
                    <a class="dropdown-item letters" href="/5.16.1/index-modules-P.html">P</a>
                    <a class="dropdown-item letters" href="/5.16.1/index-modules-S.html">S</a>
                    <a class="dropdown-item letters" href="/5.16.1/index-modules-T.html">T</a>
                    <a class="dropdown-item letters" href="/5.16.1/index-modules-U.html">U</a>
                    <a class="dropdown-item letters" href="/5.16.1/index-modules-X.html">X</a>
                    </div>
                </div>
              </li>
            </ul>
          </div>
          <!--/.nav-collapse -->
        </nav>

      <main class="row main-content pb-5 pt-5">
        <div class="col-sm-8 offset-sm-2">
          <div class="row">
            <div class="col-sm-12">
                <div id="breadcrumbs">
                    
    <a href="index.html">Home</a>&nbsp; &gt;
    
      
        <a href="index-modules-D.html">Core modules (D)</a> &gt;
      
    
    DBM_Filter
  

                </div>
            </div>
          </div>
          <div class="row">
              <article class="col-sm-12 content">
                <div class="documentation-wrapper">
                  <div id="perl_version">
                    <h1 class='page-title'> Perl 5 version 16.1 documentation</h1>
                  </div>
                  <h1>DBM_Filter</h1>


  <!--    -->
<ul><li><a href="#NAME">NAME</a></li><li><a href="#SYNOPSIS">SYNOPSIS</a></li><li><a href="#DESCRIPTION">DESCRIPTION</a></li><li><a href="#What-is-a-DBM-Filter%3f">What is a DBM Filter?</a></li><ul><li><a href="#So-what's-new%3f">So what's new?</a></li></ul><li><a href="#METHODS">METHODS</a></li><ul><li><a href="#%24db-%3eFilter_Push()-%2f-%24db-%3eFilter_Key_Push()-%2f-%24db-%3eFilter_Value_Push()">$db->Filter_Push() / $db->Filter_Key_Push() / $db->Filter_Value_Push()</a></li><li><a href="#%24db-%3eFilter_Pop()">$db->Filter_Pop()</a></li><li><a href="#%24db-%3eFiltered()">$db->Filtered()</a></li></ul><li><a href="#Writing-a-Filter">Writing a Filter</a></li><ul><li><a href="#Immediate-Filters">Immediate Filters</a></li><li><a href="#Canned-Filters">Canned Filters</a></li></ul><li><a href="#Filters-Included">Filters Included</a></li><li><a href="#NOTES">NOTES</a></li><ul><li><a href="#Maintain-Round-Trip-Integrity">Maintain Round Trip Integrity</a></li><li><a href="#Don't-mix-filtered-%26-non-filtered-data-in-the-same-database-file.">Don't mix filtered & non-filtered data in the same database file.</a></li></ul><li><a href="#EXAMPLE">EXAMPLE</a></li><li><a href="#SEE-ALSO">SEE ALSO</a></li><li><a href="#AUTHOR">AUTHOR</a></li></ul><a id="NAME"></a><h2 class='h2' >NAME</h2>
<p>DBM_Filter -- Filter DBM keys/values</p>
<a id="SYNOPSIS"></a><h2 class='h2' >SYNOPSIS</h2>
<pre>
    <a class="l_k" href="functions/use.html">use</a> <span class="w">DBM_Filter</span> <span class="sc">;</span>
    <a class="l_k" href="functions/use.html">use</a> <span class="w">SDBM_File</span><span class="sc">;</span> <span class="c"># or DB_File, or GDBM_File, or NDBM_File, or ODBM_File</span>

    <span class="i">$db</span> = <a class="l_k" href="functions/tie.html">tie</a> <span class="i">%hash</span><span class="cm">,</span> ...

    <span class="i">$db</span><span class="i">-&gt;Filter_Push</span><span class="s">(</span><span class="w">Fetch</span> <span class="cm">=&gt;</span> <a class="l_k" href="functions/sub.html">sub</a> <span class="s">{</span>...<span class="s">}</span><span class="cm">,</span>
                     <span class="w">Store</span> <span class="cm">=&gt;</span> <a class="l_k" href="functions/sub.html">sub</a> <span class="s">{</span>...<span class="s">}</span><span class="s">)</span><span class="sc">;</span>

    <span class="i">$db</span><span class="i">-&gt;Filter_Push</span><span class="s">(</span><span class="q">&#39;my_filter1&#39;</span><span class="s">)</span><span class="sc">;</span>
    <span class="i">$db</span><span class="i">-&gt;Filter_Push</span><span class="s">(</span><span class="q">&#39;my_filter2&#39;</span><span class="cm">,</span> <span class="w">params</span>...<span class="s">)</span><span class="sc">;</span>

    <span class="i">$db</span><span class="i">-&gt;Filter_Key_Push</span><span class="s">(</span>...<span class="s">)</span> <span class="sc">;</span>
    <span class="i">$db</span><span class="i">-&gt;Filter_Value_Push</span><span class="s">(</span>...<span class="s">)</span> <span class="sc">;</span>

    <span class="i">$db</span><span class="i">-&gt;Filter_Pop</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
    <span class="i">$db</span><span class="i">-&gt;Filtered</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>

<a name="package-DBM_Filter::my_filter1"></a>    package <span class="i">DBM_Filter::my_filter1</span><span class="sc">;</span>
    
<a name="Store"></a>    sub <span class="m">Store</span> <span class="s">{</span> ... <span class="s">}</span>
<a name="Fetch"></a>    sub <span class="m">Fetch</span> <span class="s">{</span> ... <span class="s">}</span>

    <span class="n">1</span><span class="sc">;</span>

<a name="package-DBM_Filter::my_filter2"></a>    package <span class="i">DBM_Filter::my_filter2</span><span class="sc">;</span>

<a name="Filter"></a>    sub <span class="m">Filter</span>
    <span class="s">{</span>
        <a class="l_k" href="functions/my.html">my</a> <span class="i">@opts</span> = <span class="i">@_</span><span class="sc">;</span>
        ...
        <a class="l_k" href="functions/return.html">return</a> <span class="s">(</span>
<a name="Store-1"></a>            sub <span class="m">Store</span> <span class="s">{</span> ... <span class="s">}</span><span class="cm">,</span>
<a name="Fetch-1"></a>            sub <span class="m">Fetch</span> <span class="s">{</span> ... <span class="s">}</span> <span class="s">)</span><span class="sc">;</span>
    <span class="s">}</span>

    <span class="n">1</span><span class="sc">;</span></pre>
<a id="DESCRIPTION"></a><h2 class='h2' >DESCRIPTION</h2>
<p>This module provides an interface that allows filters to be applied
to tied Hashes associated with DBM files. It builds on the DBM Filter
hooks that are present in all the *DB*_File modules included with the
standard Perl source distribution from version 5.6.1 onwards. In addition
to the *DB*_File modules distributed with Perl, the BerkeleyDB module,
available on CPAN, supports the DBM Filter hooks. See <a href="perldbmfilter.html">perldbmfilter</a>
for more details on the DBM Filter hooks.</p>
<a id="What-is-a-DBM-Filter%3f"></a><h2 class='h2' >What is a DBM Filter?</h2>
<p>A DBM Filter allows the keys and/or values in a tied hash to be modified
by some user-defined code just before it is written to the DBM file and
just after it is read back from the DBM file. For example, this snippet
of code</p>
<pre>
    <span class="i">$some_hash</span>{<span class="q">&quot;abc&quot;</span>} = <span class="n">42</span><span class="sc">;</span></pre>
<p>could potentially trigger two filters, one for the writing of the key
"abc" and another for writing the value 42.  Similarly, this snippet</p>
<pre>
    <a class="l_k" href="functions/my.html">my</a> <span class="s">(</span><span class="i">$key</span><span class="cm">,</span> <span class="i">$value</span><span class="s">)</span> = <a class="l_k" href="functions/each.html">each</a> <span class="i">%some_hash</span></pre>
<p>will trigger two filters, one for the reading of the key and one for
the reading of the value.</p>
<p>Like the existing DBM Filter functionality, this module arranges for the
<pre>
<span class="i">$_</span></code>
 variable to be populated with the key or value that a filter will
check. This usually means that most DBM filters tend to be very short.</p>
<a id="So-what's-new%3f"></a><h3 class='h3' >So what's new?</h3>
<p>The main enhancements over the standard DBM Filter hooks are:</p>
<ul>
<li>
<p>A cleaner interface.</p>
</li>
<li>
<p>The ability to easily apply multiple filters to a single DBM file.</p>
</li>
<li>
<p>The ability to create "canned" filters. These allow commonly used filters
to be packaged into a stand-alone module.</p>
</li>
</ul>
<a id="METHODS"></a><h2 class='h2' >METHODS</h2>
<p>This module will arrange for the following methods to be available via
the object returned from the <code class="inline"><a class="l_k" href="functions/tie.html">tie</a></code> call.</p>
<a id="%24db-%3eFilter_Push()-%2f-%24db-%3eFilter_Key_Push()-%2f-%24db-%3eFilter_Value_Push()"></a><h3 class='h3' >$db-&gt;Filter_Push() / $db-&gt;Filter_Key_Push() / $db-&gt;Filter_Value_Push()</h3>
<p>Add a filter to filter stack for the database, <pre>
<span class="i">$db</span></code>
. The three formats
vary only in whether they apply to the DBM key, the DBM value or both.</p>
<ul>
<li><a id="Filter_Push"></a><strong>Filter_Push</strong>
<p>The filter is applied to <i>both</i> keys and values.</p>
</li>
<li><a id="Filter_Key_Push"></a><strong>Filter_Key_Push</strong>
<p>The filter is applied to the key <i>only</i>.</p>
</li>
<li><a id="Filter_Value_Push"></a><strong>Filter_Value_Push</strong>
<p>The filter is applied to the value <i>only</i>.</p>
</li>
</ul>
<a id="%24db-%3eFilter_Pop()"></a><h3 class='h3' >$db-&gt;Filter_Pop()</h3>
<p>Removes the last filter that was applied to the DBM file associated with
<pre>
<span class="i">$db</span></code>
, if present.</p>
<a id="%24db-%3eFiltered()"></a><h3 class='h3' >$db-&gt;Filtered()</h3>
<p>Returns TRUE if there are any filters applied to the DBM associated
with <pre>
<span class="i">$db</span></code>
.  Otherwise returns FALSE.</p>
<a id="Writing-a-Filter"></a><h2 class='h2' >Writing a Filter</h2>
<p>Filters can be created in two main ways</p>
<a id="Immediate-Filters"></a><h3 class='h3' >Immediate Filters</h3>
<p>An immediate filter allows you to specify the filter code to be used
at the point where the filter is applied to a dbm. In this mode the
Filter_*_Push methods expects to receive exactly two parameters.</p>
<pre>
    <a class="l_k" href="functions/my.html">my</a> <span class="i">$db</span> = <a class="l_k" href="functions/tie.html">tie</a> <span class="i">%hash</span><span class="cm">,</span> <span class="q">&#39;SDBM_File&#39;</span><span class="cm">,</span> ...
    <span class="i">$db</span><span class="i">-&gt;Filter_Push</span><span class="s">(</span> <span class="w">Store</span> <span class="cm">=&gt;</span> <a class="l_k" href="functions/sub.html">sub</a> <span class="s">{</span> <span class="s">}</span><span class="cm">,</span>
                      <span class="w">Fetch</span> <span class="cm">=&gt;</span> <a class="l_k" href="functions/sub.html">sub</a> <span class="s">{</span> <span class="s">}</span><span class="s">)</span><span class="sc">;</span></pre>
<p>The code reference associated with <pre>
<span class="w">Store</span></code>
 will be called before any
key/value is written to the database and the code reference associated
with <pre>
<span class="w">Fetch</span></code>
 will be called after any key/value is read from the
database.</p>
<p>For example, here is a sample filter that adds a trailing NULL character
to all strings before they are written to the DBM file, and removes the
trailing NULL when they are read from the DBM file</p>
<pre>
    <a class="l_k" href="functions/my.html">my</a> <span class="i">$db</span> = <a class="l_k" href="functions/tie.html">tie</a> <span class="i">%hash</span><span class="cm">,</span> <span class="q">&#39;SDBM_File&#39;</span><span class="cm">,</span> ...
    <span class="i">$db</span><span class="i">-&gt;Filter_Push</span><span class="s">(</span> <span class="w">Store</span> <span class="cm">=&gt;</span> <a class="l_k" href="functions/sub.html">sub</a> <span class="s">{</span> <span class="i">$_</span> .= <span class="q">&quot;\x00&quot;</span> <span class="sc">;</span> <span class="s">}</span><span class="cm">,</span>
                      <span class="w">Fetch</span> <span class="cm">=&gt;</span> <a class="l_k" href="functions/sub.html">sub</a> <span class="s">{</span> <span class="q">s/\x00$//</span> <span class="sc">;</span>    <span class="s">}</span><span class="s">)</span><span class="sc">;</span></pre>
<p>Points to note:</p>
<dl>
<dt>1.</dt><dd>
<p>Both the Store and Fetch filters manipulate <pre>
<span class="i">$_</span></code>
.</p>
</dd>
</dl>
<a id="Canned-Filters"></a><h3 class='h3' >Canned Filters</h3>
<p>Immediate filters are useful for one-off situations. For more generic
problems it can be useful to package the filter up in its own module.</p>
<p>The usage is for a canned filter is:</p>
<pre>
    <span class="i">$db</span><span class="i">-&gt;Filter_Push</span><span class="s">(</span><span class="q">&quot;name&quot;</span><span class="cm">,</span> <span class="w">params</span><span class="s">)</span></pre>
<p>where</p>
<ul>
<li><a id="%22name%22"></a><strong>"name"</strong>
<p>is the name of the module to load. If the string specified does not
contain the package separator characters "::", it is assumed to refer to
the full module name "DBM_Filter::name". This means that the full names
for canned filters, "null" and "utf8", included with this module are:</p>
<pre>
    <span class="w">DBM_Filter::null</span>
    <span class="w">DBM_Filter::utf8</span></pre>
</li>
<li><a id="params"></a><strong>params</strong>
<p>any optional parameters that need to be sent to the filter. See the
encode filter for an example of a module that uses parameters.</p>
</li>
</ul>
<p>The module that implements the canned filter can take one of two
forms. Here is a template for the first</p>
<pre>
<a name="package-DBM_Filter::null"></a>    package <span class="i">DBM_Filter::null</span> <span class="sc">;</span>

    <a class="l_k" href="functions/use.html">use</a> <span class="w">strict</span><span class="sc">;</span>
    <a class="l_k" href="functions/use.html">use</a> <span class="w">warnings</span><span class="sc">;</span>

<a name="Store"></a>    sub <span class="m">Store</span> 
    <span class="s">{</span>
        <span class="c"># store code here    </span>
    <span class="s">}</span>

<a name="Fetch"></a>    sub <span class="m">Fetch</span>
    <span class="s">{</span>
        <span class="c"># fetch code here</span>
    <span class="s">}</span>

    <span class="n">1</span><span class="sc">;</span></pre>
<p>Notes:</p>
<dl>
<dt>1.</dt><dd>
<p>The package name uses the <pre>
<span class="w">DBM_Filter::</span></code>
 prefix.</p>
</dd>
<dt>2.</dt><dd>
<p>The module <i>must</i> have both a Store and a Fetch method. If only one is
present, or neither are present, a fatal error will be thrown.</p>
</dd>
</dl>
<p>The second form allows the filter to hold state information using a
closure, thus:</p>
<pre>
<a name="package-DBM_Filter::encoding"></a>    package <span class="i">DBM_Filter::encoding</span> <span class="sc">;</span>

    <a class="l_k" href="functions/use.html">use</a> <span class="w">strict</span><span class="sc">;</span>
    <a class="l_k" href="functions/use.html">use</a> <span class="w">warnings</span><span class="sc">;</span>

<a name="Filter"></a>    sub <span class="m">Filter</span>
    <span class="s">{</span>
        <a class="l_k" href="functions/my.html">my</a> <span class="i">@params</span> = <span class="i">@_</span> <span class="sc">;</span>

        ...
        <a class="l_k" href="functions/return.html">return</a> <span class="s">{</span>
            <span class="w">Store</span>   <span class="cm">=&gt;</span> <a class="l_k" href="functions/sub.html">sub</a> <span class="s">{</span> <span class="i">$_</span> = <span class="i">$encoding</span><span class="i">-&gt;encode</span><span class="s">(</span><span class="i">$_</span><span class="s">)</span> <span class="s">}</span><span class="cm">,</span>
            <span class="w">Fetch</span>   <span class="cm">=&gt;</span> <a class="l_k" href="functions/sub.html">sub</a> <span class="s">{</span> <span class="i">$_</span> = <span class="i">$encoding</span><span class="i">-&gt;decode</span><span class="s">(</span><span class="i">$_</span><span class="s">)</span> <span class="s">}</span>
            <span class="s">}</span> <span class="sc">;</span>
    <span class="s">}</span>

    <span class="n">1</span><span class="sc">;</span></pre>
<p>In this instance the "Store" and "Fetch" methods are encapsulated inside a
"Filter" method.</p>
<a id="Filters-Included"></a><h2 class='h2' >Filters Included</h2>
<p>A number of canned filers are provided with this module. They cover a
number of the main areas that filters are needed when interfacing with
DBM files. They also act as templates for your own filters.</p>
<p>The filter included are:</p>
<ul>
<li><a id="*-utf8"></a><strong>utf8</strong>
<p>This module will ensure that all data written to the DBM will be encoded
in UTF-8.</p>
<p>This module needs the Encode module.</p>
</li>
<li><a id="*-encode"></a><strong>encode</strong>
<p>Allows you to choose the character encoding will be store in the DBM file.</p>
</li>
<li><a id="*-compress"></a><strong>compress</strong>
<p>This filter will compress all data before it is written to the database
and uncompressed it on reading.</p>
<p>This module needs Compress::Zlib.</p>
</li>
<li><a id="*-int32"></a><strong>int32</strong>
<p>This module is used when interoperating with a C/C++ application that
uses a C int as either the key and/or value in the DBM file.</p>
</li>
<li><a id="*-null"></a><strong>null</strong>
<p>This module ensures that all data written to the DBM file is null
terminated. This is useful when you have a perl script that needs
to interoperate with a DBM file that a C program also uses. A fairly
common issue is for the C application to include the terminating null
in a string when it writes to the DBM file. This filter will ensure that
all data written to the DBM file can be read by the C application.</p>
</li>
</ul>
<a id="NOTES"></a><h2 class='h2' >NOTES</h2>
<a id="Maintain-Round-Trip-Integrity"></a><h3 class='h3' >Maintain Round Trip Integrity</h3>
<p>When writing a DBM filter it is <i>very</i> important to ensure that it is
possible to retrieve all data that you have written when the DBM filter
is in place. In practice, this means that whatever transformation is
applied to the data in the Store method, the <i>exact</i> inverse operation
should be applied in the Fetch method.</p>
<p>If you don't provide an exact inverse transformation, you will find that
code like this will not behave as you expect.</p>
<pre>
     <a class="l_k" href="functions/while.html">while</a> <span class="s">(</span><a class="l_k" href="functions/my.html">my</a> <span class="s">(</span><span class="i">$k</span><span class="cm">,</span> <span class="i">$v</span><span class="s">)</span> = <a class="l_k" href="functions/each.html">each</a> <span class="i">%hash</span><span class="s">)</span>
     <span class="s">{</span>
         ...
     <span class="s">}</span></pre>
<p>Depending on the transformation, you will find that one or more of the
following will happen</p>
<dl>
<dt>1</dt><dd>
<p>The loop will never terminate.</p>
</dd>
<dt>2</dt><dd>
<p>Too few records will be retrieved.</p>
</dd>
<dt>3</dt><dd>
<p>Too many will be retrieved.</p>
</dd>
<dt>4</dt><dd>
<p>The loop will do the right thing for a while, but it will unexpectedly fail.</p>
</dd>
</dl>
<a id="Don't-mix-filtered-%26-non-filtered-data-in-the-same-database-file."></a><h3 class='h3' >Don't mix filtered &amp; non-filtered data in the same database file.</h3>
<p>This is just a restatement of the previous section. Unless you are
completely certain you know what you are doing, avoid mixing filtered &amp;
non-filtered data.</p>
<a id="EXAMPLE"></a><h2 class='h2' >EXAMPLE</h2>
<p>Say you need to interoperate with a legacy C application that stores
keys as C ints and the values and null terminated UTF-8 strings. Here
is how you would set that up</p>
<pre>
    <a class="l_k" href="functions/my.html">my</a> <span class="i">$db</span> = <a class="l_k" href="functions/tie.html">tie</a> <span class="i">%hash</span><span class="cm">,</span> <span class="q">&#39;SDBM_File&#39;</span><span class="cm">,</span> ...

    <span class="i">$db</span><span class="i">-&gt;Filter_Key_Push</span><span class="s">(</span><span class="q">&#39;int32&#39;</span><span class="s">)</span> <span class="sc">;</span>

    <span class="i">$db</span><span class="i">-&gt;Filter_Value_Push</span><span class="s">(</span><span class="q">&#39;utf8&#39;</span><span class="s">)</span><span class="sc">;</span>
    <span class="i">$db</span><span class="i">-&gt;Filter_Value_Push</span><span class="s">(</span><span class="q">&#39;null&#39;</span><span class="s">)</span><span class="sc">;</span></pre>
<a id="SEE-ALSO"></a><h2 class='h2' >SEE ALSO</h2>
<p>&lt;DB_File&gt;,  <a href="https://search.cpan.org/perldoc/GDBM_File">GDBM_File</a>, <a href="https://search.cpan.org/perldoc/NDBM_File">NDBM_File</a>, <a href="https://search.cpan.org/perldoc/ODBM_File">ODBM_File</a>, <a href="SDBM_File.html">SDBM_File</a>, <a href="perldbmfilter.html">perldbmfilter</a></p>
<a id="AUTHOR"></a><h2 class='h2' >AUTHOR</h2>
<p>Paul Marquess &lt;pmqs@cpan.org&gt;</p>




      <ul><li><a href="#NAME">NAME</a></li><li><a href="#SYNOPSIS">SYNOPSIS</a></li><li><a href="#DESCRIPTION">DESCRIPTION</a></li><li><a href="#What-is-a-DBM-Filter%3f">What is a DBM Filter?</a></li><ul><li><a href="#So-what's-new%3f">So what's new?</a></li></ul><li><a href="#METHODS">METHODS</a></li><ul><li><a href="#%24db-%3eFilter_Push()-%2f-%24db-%3eFilter_Key_Push()-%2f-%24db-%3eFilter_Value_Push()">$db->Filter_Push() / $db->Filter_Key_Push() / $db->Filter_Value_Push()</a></li><li><a href="#%24db-%3eFilter_Pop()">$db->Filter_Pop()</a></li><li><a href="#%24db-%3eFiltered()">$db->Filtered()</a></li></ul><li><a href="#Writing-a-Filter">Writing a Filter</a></li><ul><li><a href="#Immediate-Filters">Immediate Filters</a></li><li><a href="#Canned-Filters">Canned Filters</a></li></ul><li><a href="#Filters-Included">Filters Included</a></li><li><a href="#NOTES">NOTES</a></li><ul><li><a href="#Maintain-Round-Trip-Integrity">Maintain Round Trip Integrity</a></li><li><a href="#Don't-mix-filtered-%26-non-filtered-data-in-the-same-database-file.">Don't mix filtered & non-filtered data in the same database file.</a></li></ul><li><a href="#EXAMPLE">EXAMPLE</a></li><li><a href="#SEE-ALSO">SEE ALSO</a></li><li><a href="#AUTHOR">AUTHOR</a></li></ul>


                </div>
              </article>
          </div>
        </div>
      </main>
    </div>
    <footer class="footer row bg-light pt-5 pb-5">
      <div class="col-sm-8 offset-sm-2">
        <div class="row">
          <div class="col-md-4">
            <ul class="list-unstyled">
              <li>
                <h4>Site info</h4>
              </li>
              <li>Docs mantained by
                <a href="//lists.cpan.org/showlist.cgi?name=perl5-porters" rel="noopener">Perl 5 Porters</a>
              </li>
              <li>Site development sponsored by
                <a href="//opusvl.com" rel="noopener"><img class="opus-logo" src="/public/img/opusvl_logo.svg" alt="OpusVL Logo"></a>
              </li>
            </ul>
          </div>
          <div class="col-md-8">
            <div class="row">
              <div class="col-md-6 col-lg-3">
                <ul class=" list-unstyled">
                  <li>
                    <h4>Manual</h4>
                  </li>
                  <li>
                    <a href="/5/16/1/index-overview.html">Overview</a>
                  </li>
                  <li>
                    <a href="/5/16/1/index-tutorials.html">Tutorials</a>
                  </li>
                  <li>
                    <a href="/5/16/1/index-faq.html">FAQs</a>
                  </li>
                  <li>
                    <a href="/5/16/1/index-history.html">Changes</a>
                  </li>
                </ul>
              </div>
              <div class="col-md-6 col-lg-3">
                <ul class=" list-unstyled">
                  <li>
                    <h4>Reference</h4>
                  </li>
                  <li>
                    <a href="/5/16/1/index-language.html">Language</a>
                  </li>
                  <li>
                    <a href="/5/16/1/index-functions.html">Functions</a>
                  </li>
                  <li>
                    <a href="/5/16/1/perlop.html">Operators</a>
                  </li>
                  <li>
                    <a href="/5/16/1/perlvar.html">Variables</a>
                  </li>
                </ul>
              </div>
              <div class="col-md-6 col-lg-3">
                <ul class=" list-unstyled">
                  <li>
                    <h4>Modules</h4>
                  </li>
                  <li>
                    <a href="/5/16/1/index-modules-A.html">Modules</a>
                  </li>
                  <li>
                    <a href="/5/16/1/index-pragmas.html">Pragmas</a>
                  </li>
                  <li>
                    <a href="/5/16/1/index-utilities.html">Utilities</a>
                  </li>
                </ul>
              </div>
              <div class="col-md-6 col-lg-3">
                <ul class=" list-unstyled">
                  <li>
                    <h4>Misc</h4>
                  </li>
                  <li>
                    <a href="/5/16/1/index-licence.html">License</a>
                  </li>
                  <li>
                    <a href="/5/16/1/index-internals.html">Internals</a>
                  </li>
                  <li>
                    <a href="/5/16/1/index-platforms.html">Platforms</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class=" col-12 footer-inf text-center">
            <small>perldoc.perl.org - Official documentation for the Perl programming language</small>
          </div>
        </div>
      </div>
    </footer>
    <div class="beta-wrapper beta-bottom-right ">
      <div class="beta beta-blue  ">
        <a class="beta-link " href="https://github.com/OpusVL/perldoc.perl.org/issues/new" rel="noopener">
          <span class="beta-text">
            This is a Beta release.
          </span>
          <span class="beta-text">
            For any issues please raise a ticket on GitHub
          </span>
        </a>
      </div>
    </div>
    <script src="/public/js/main.min.js"></script>
  </body>
</html>
