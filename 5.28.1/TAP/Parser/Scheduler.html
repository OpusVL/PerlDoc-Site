<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="TAP::Parser::Scheduler - perldoc.perl.org">
    <link rel="icon" href="/public/img/favicon.ico">
    <title>TAP::Parser::Scheduler - perldoc.perl.org</title>
    <link href="/public/css/main.min.css" rel="stylesheet">
    <link href='https://fonts.googleapis.com/css?family=Lato:400,100,300,700,900' rel='stylesheet' type='text/css'>
    <script>
            window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
            ga('create', 'UA-1892152-2', 'auto');  // JJ's account
            ga('create', 'UA-50555-3', 'auto', 'perlOrg');   // perl.org account
            ga('require', 'outboundLinkTracker', {
              events: ['click', 'auxclick', 'contextmenu'],
            });
            ga('require', 'maxScrollTracker');
            ga('send', 'pageview');
            ga('perlOrg.send', 'pageview');
    </script>
    <script async src="https://www.google-analytics.com/analytics.js"></script>
    <script async src="/public/js/tracking.min.js"></script>
  </head>
  <body class="body container-fluid ">
    <div class="wrapper">
        <nav class="navbar navbar-expand-md navbar-dark bg-primary bg-perl fixed-top justify-content-between">
          <a class="navbar-brand" href="/">
            <object class="logo" data="/public/img/logo_perl_doc.svg" type="image/svg+xml" name="Perl Documentation Logo">Perl Documentation Logo</object>
          </a>
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div id="navbar" class="collapse navbar-collapse justify-content-end">
            <ul class="nav navbar-nav navbar-right">
              <li class="nav-item dropdown">
                <a id="navbarDropdown" href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Perl versions</a>
                <div class="dropdown-menu" id="dropdown-menu-links" aria-labelledby="navbarDropdown">
                </div>
              </li>
              <li class="nav-item dropdown">
                <a id="navbarDropdown1" href="#" class="dropdown-toggle nav-link" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Manuals</a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown1">
                  <a class="dropdown-item" href="/5.28.1/index-overview.html">Overview</a>
                  <a class="dropdown-item" href="/5.28.1/index-tutorials.html">Tutorials</a>
                  <a class="dropdown-item" href="/5.28.1/index-faq.html">FAQs</a>
                  <a class="dropdown-item" href="/5.28.1/index-history.html">History / Changes</a>
                  <a class="dropdown-item" href="/5.28.1/index-licence.html">License</a>
                  <a class="dropdown-item" href="/5.28.1/index-language.html">Language</a>
                  <a class="dropdown-item" href="/5.28.1/index-functions.html">Functions</a>
                  <a class="dropdown-item" href="/5.28.1/perlop.html">Operators</a>
                  <a class="dropdown-item" href="/5.28.1/perlvar.html">Special Variables</a>
                  <a class="dropdown-item" href="/5.28.1/index-pragmas.html">Pragmas</a>
                  <a class="dropdown-item" href="/5.28.1/index-utilities.html">Utilities</a>
                  <a class="dropdown-item" href="/5.28.1/index-internals.html">Internals</a>
                  <a class="dropdown-item" href="/5.28.1/index-platforms.html">Platform Specific</a>
                </div>
              </li>
              <li class="nav-item dropdown">
                <a id="navbarDropdown3" href="#" class="nav-link dropdown-toggle " data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Modules</a>
                <div aria-labelledby="navbarDropdown3" class="dropdown-menu letters-wrap">
                  <a class="dropdown-item" href="/5.28.1/index-functions.html">A-Z</a>
                  <a class="dropdown-item" href="/5.28.1/index-functions-by-cat.html">By Category</a>
                  <div class="dropdown-divider"></div>
                  <div class="letter-container">
                    <a class="dropdown-item letters" href="/5.28.1/index-modules-A.html">A</a>
                    <a class="dropdown-item letters" href="/5.28.1/index-modules-B.html">B</a>
                    <a class="dropdown-item letters" href="/5.28.1/index-modules-C.html">C</a>
                    <a class="dropdown-item letters" href="/5.28.1/index-modules-D.html">D</a>
                    <a class="dropdown-item letters" href="/5.28.1/index-modules-E.html">E</a>
                    <a class="dropdown-item letters" href="/5.28.1/index-modules-F.html">F</a>
                    <a class="dropdown-item letters" href="/5.28.1/index-modules-G.html">G</a>
                    <a class="dropdown-item letters" href="/5.28.1/index-modules-H.html">H</a>
                    <a class="dropdown-item letters" href="/5.28.1/index-modules-I.html">I</a>
                    <a class="dropdown-item letters" href="/5.28.1/index-modules-J.html">J</a>
                    <a class="dropdown-item letters" href="/5.28.1/index-modules-L.html">L</a>
                    <a class="dropdown-item letters" href="/5.28.1/index-modules-M.html">M</a>
                    <a class="dropdown-item letters" href="/5.28.1/index-modules-N.html">N</a>
                    <a class="dropdown-item letters" href="/5.28.1/index-modules-O.html">O</a>
                    <a class="dropdown-item letters" href="/5.28.1/index-modules-P.html">P</a>
                    <a class="dropdown-item letters" href="/5.28.1/index-modules-S.html">S</a>
                    <a class="dropdown-item letters" href="/5.28.1/index-modules-T.html">T</a>
                    <a class="dropdown-item letters" href="/5.28.1/index-modules-U.html">U</a>
                    <a class="dropdown-item letters" href="/5.28.1/index-modules-X.html">X</a>
                    </div>
                </div>
              </li>
            </ul>
          </div>
          <!--/.nav-collapse -->
        </nav>

      <main class="row main-content pb-5 pt-5">
        <div class="col-sm-8 offset-sm-2">
          <div class="row">
            <div class="col-sm-12">
                <div id="breadcrumbs">
                    
    <a href="../../index.html">Home</a>&nbsp; &gt;
    
      
        <a href="../../index-modules-T.html">Core modules (T)</a> &gt;
      
    
    TAP::Parser::Scheduler
  

                </div>
            </div>
          </div>
          <div class="row">
              <article class="col-sm-12 content">
                <div class="documentation-wrapper">
                  <div id="perl_version">
                    <h1 class='page-title'> Perl 5 version 28.1 documentation</h1>
                  </div>
                  <h1>TAP::Parser::Scheduler</h1>


  <!--    -->
<ul><li><a href="#NAME">NAME</a></li><li><a href="#VERSION">VERSION</a></li><li><a href="#SYNOPSIS">SYNOPSIS</a></li><li><a href="#DESCRIPTION">DESCRIPTION</a></li><li><a href="#METHODS">METHODS</a></li><ul><li><a href="#Class-Methods">Class Methods</a></li><li><a href="#Rules-data-structure">Rules data structure</a></li><li><a href="#Instance-Methods">Instance Methods</a></li></ul></ul><a id="NAME"></a><h2 class='h2' >NAME</h2>
<p>TAP::Parser::Scheduler - Schedule tests during parallel testing</p>
<a id="VERSION"></a><h2 class='h2' >VERSION</h2>
<p>Version 3.42</p>
<a id="SYNOPSIS"></a><h2 class='h2' >SYNOPSIS</h2>
<pre>
    <a class="l_k" href="../../functions/use.html">use</a> <span class="w">TAP::Parser::Scheduler</span><span class="sc">;</span></pre>
<a id="DESCRIPTION"></a><h2 class='h2' >DESCRIPTION</h2>
<a id="METHODS"></a><h2 class='h2' >METHODS</h2>
<a id="Class-Methods"></a><h3 class='h3' >Class Methods</h3>
<a id="new"></a><h4 class='h4' ><pre>
<span class="w">new</span></code>
</h4>
<pre>
    <a class="l_k" href="../../functions/my.html">my</a> <span class="i">$sched</span> = <span class="w">TAP::Parser::Scheduler</span><span class="w">-&gt;new</span><span class="s">(</span><span class="w">tests</span> <span class="cm">=&gt;</span> \<span class="i">@tests</span><span class="s">)</span><span class="sc">;</span>
    <a class="l_k" href="../../functions/my.html">my</a> <span class="i">$sched</span> = <span class="w">TAP::Parser::Scheduler</span><span class="w">-&gt;new</span><span class="s">(</span>
        <span class="w">tests</span> <span class="cm">=&gt;</span> <span class="s">[</span> <span class="s">[</span><span class="q">&#39;t/test_name.t&#39;</span><span class="cm">,</span><span class="q">&#39;Test Description&#39;</span><span class="s">]</span><span class="cm">,</span> ... <span class="s">]</span><span class="cm">,</span>
        <span class="w">rules</span> <span class="cm">=&gt;</span> \<span class="i">%rules</span><span class="cm">,</span>
    <span class="s">)</span><span class="sc">;</span></pre>
<p>Given 'tests' and optional 'rules' as input, returns a new
<pre>
<span class="w">TAP::Parser::Scheduler</span></code>
 object.  Each member of <pre>
<span class="i">@tests</span></code>
 should be either a
a test file name, or a two element arrayref, where the first element is a test
file name, and the second element is a test description. By default, we'll use
the test name as the description.</p>
<p>The optional <pre>
<span class="w">rules</span></code>
 attribute provides direction on which tests should be run
in parallel and which should be run sequentially. If no rule data structure is
provided, a default data structure is used which makes every test eligible to
be run in parallel:</p>
<pre>
    <span class="s">{</span> <span class="w">par</span> <span class="cm">=&gt;</span> <span class="q">&#39;**&#39;</span> <span class="s">}</span><span class="cm">,</span></pre>
<p>The rules data structure is documented more in the next section.</p>
<a id="Rules-data-structure"></a><h3 class='h3' >Rules data structure</h3>
<p>The "<pre>
<span class="w">rules</span></code>
" data structure is the the heart of the scheduler. It allows you
to express simple rules like "run all tests in sequence" or "run all tests in
parallel except these five tests.". However, the rules structure also supports
glob-style pattern matching and recursive definitions, so you can also express
arbitarily complicated patterns.</p>
<p>The rule must only have one top level key: either 'par' for "parallel" or 'seq'
for "sequence".</p>
<p>Values must be either strings with possible glob-style matching, or arrayrefs
of strings or hashrefs which follow this pattern recursively.</p>
<p>Every element in an arrayref directly below a 'par' key is eligible to be run
in parallel, while vavalues directly below a 'seq' key must be run in sequence.</p>
<a id="Rules-examples"></a><h4 class='h4' >Rules examples</h4>
<p>Here are some examples:</p>
<pre>
    <span class="c"># All tests be run in parallel (the default rule)</span>
    <span class="s">{</span> <span class="w">par</span> <span class="cm">=&gt;</span> <span class="q">&#39;**&#39;</span> <span class="s">}</span><span class="cm">,</span>

    <span class="c"># Run all tests in sequence, except those starting with &quot;p&quot;</span>
    <span class="s">{</span> <span class="w">par</span> <span class="cm">=&gt;</span> <span class="q">&#39;t/p*.t&#39;</span> <span class="s">}</span><span class="cm">,</span>

    <span class="c"># Run all tests in parallel, except those starting with &quot;p&quot;</span>
    <span class="s">{</span>
        <span class="w">seq</span> <span class="cm">=&gt;</span> <span class="s">[</span>
                  <span class="s">{</span> <span class="w">seq</span> <span class="cm">=&gt;</span> <span class="q">&#39;t/p*.t&#39;</span> <span class="s">}</span><span class="cm">,</span>
                  <span class="s">{</span> <span class="w">par</span> <span class="cm">=&gt;</span> <span class="q">&#39;**&#39;</span>     <span class="s">}</span><span class="cm">,</span>
               <span class="s">]</span><span class="cm">,</span>
    <span class="s">}</span>

    <span class="c"># Run some  startup tests in sequence, then some parallel tests then some</span>
    <span class="c"># teardown tests in sequence.</span>
    <span class="s">{</span>
        <span class="w">seq</span> <span class="cm">=&gt;</span> <span class="s">[</span>
            <span class="s">{</span> <span class="w">seq</span> <span class="cm">=&gt;</span> <span class="q">&#39;t/startup/*.t&#39;</span> <span class="s">}</span><span class="cm">,</span>
            <span class="s">{</span> <span class="w">par</span> <span class="cm">=&gt;</span> <span class="s">[</span><span class="q">&#39;t/a/*.t&#39;</span><span class="cm">,</span><span class="q">&#39;t/b/*.t&#39;</span><span class="cm">,</span><span class="q">&#39;t/c/*.t&#39;</span><span class="s">]</span><span class="cm">,</span> <span class="s">}</span>
            <span class="s">{</span> <span class="w">seq</span> <span class="cm">=&gt;</span> <span class="q">&#39;t/shutdown/*.t&#39;</span> <span class="s">}</span><span class="cm">,</span>
        <span class="s">]</span><span class="cm">,</span>
    <span class="s">}</span><span class="cm">,</span></pre>
<a id="Rules-resolution"></a><h4 class='h4' >Rules resolution</h4>
<ul>
<li><a id="*-By-default%2c-all-tests-are-eligible-to-be-run-in-parallel.-Specifying-any-of-your-own-rules-removes-this-one."></a><strong>By default, all tests are eligible to be run in parallel. Specifying any of your own rules removes this one.</strong>
</li>
<li><a id="*-%22First-match-wins%22.-The-first-rule-that-matches-a-test-will-be-the-one-that-applies."></a><strong>"First match wins". The first rule that matches a test will be the one that applies.</strong>
</li>
<li><a id="*-Any-test-which-does-not-match-a-rule-will-be-run-in-sequence-at-the-end-of-the-run."></a><strong>Any test which does not match a rule will be run in sequence at the end of the run.</strong>
</li>
<li><a id="*-The-existence-of-a-rule-does-not-imply-selecting-a-test.-You-must-still-specify-the-tests-to-run."></a><strong>The existence of a rule does not imply selecting a test. You must still specify the tests to run.</strong>
</li>
<li><a id="*-Specifying-a-rule-to-allow-tests-to-run-in-parallel-does-not-make-the-run-in-parallel.-You-still-need-specify-the-number-of-parallel-jobs-in-your-Harness-object."></a><strong>Specifying a rule to allow tests to run in parallel does not make the run in parallel. You still need specify the number of parallel <pre>
<span class="w">jobs</span></code>
 in your Harness object.</strong>
</li>
</ul>
<a id="Glob-style-pattern-matching-for-rules"></a><h4 class='h4' >Glob-style pattern matching for rules</h4>
<p>We implement our own glob-style pattern matching. Here are the patterns it supports:</p>
<div class="verbatim"><ol><li>    ** is any number of characters, including /, within a pathname</li><li>    * is zero or more characters within a filename/directory name</li><li>    ? is exactly one character within a filename/directory name</li><li>    {foo,bar,baz} is any of foo, bar or baz.</li><li>    \ is an escape character</li></ol></div><a id="Instance-Methods"></a><h3 class='h3' >Instance Methods</h3>
<a id="get_all"></a><h4 class='h4' ><pre>
<span class="w">get_all</span></code>
</h4>
<p>Get a list of all remaining tests.</p>
<a id="get_job"></a><h4 class='h4' ><pre>
<span class="w">get_job</span></code>
</h4>
<p>Return the next available job as <a href="../../TAP/Parser/Scheduler/Job.html">TAP::Parser::Scheduler::Job</a> object or
<code class="inline"><a class="l_k" href="../../functions/undef.html">undef</a></code> if none are available. Returns a <a href="../../TAP/Parser/Scheduler/Spinner.html">TAP::Parser::Scheduler::Spinner</a> if
the scheduler still has pending jobs but none are available to run right now.</p>
<a id="as_string"></a><h4 class='h4' ><pre>
<span class="w">as_string</span></code>
</h4>
<p>Return a human readable representation of the scheduling tree.
For example:</p>
<pre>
    <a class="l_k" href="../../functions/my.html">my</a> <span class="i">@tests</span> = <span class="s">(</span><span class="q">qw{</span>
        <span class="q">t/startup/foo.t </span>
        <span class="q">t/shutdown/foo.t</span>
    
        <span class="q">t/a/foo.t t/b/foo.t t/c/foo.t t/d/foo.t</span>
    <span class="q">}</span><span class="s">)</span><span class="sc">;</span>
    <a class="l_k" href="../../functions/my.html">my</a> <span class="i">$sched</span> = <span class="w">TAP::Parser::Scheduler</span><span class="w">-&gt;new</span><span class="s">(</span>
        <span class="w">tests</span> <span class="cm">=&gt;</span> \<span class="i">@tests</span><span class="cm">,</span>
        <span class="w">rules</span> <span class="cm">=&gt;</span> <span class="s">{</span>
            <span class="w">seq</span> <span class="cm">=&gt;</span> <span class="s">[</span>
                <span class="s">{</span> <span class="w">seq</span> <span class="cm">=&gt;</span> <span class="q">&#39;t/startup/*.t&#39;</span> <span class="s">}</span><span class="cm">,</span>
                <span class="s">{</span> <span class="w">par</span> <span class="cm">=&gt;</span> <span class="s">[</span><span class="q">&#39;t/a/*.t&#39;</span><span class="cm">,</span><span class="q">&#39;t/b/*.t&#39;</span><span class="cm">,</span><span class="q">&#39;t/c/*.t&#39;</span><span class="s">]</span> <span class="s">}</span><span class="cm">,</span>
                <span class="s">{</span> <span class="w">seq</span> <span class="cm">=&gt;</span> <span class="q">&#39;t/shutdown/*.t&#39;</span> <span class="s">}</span><span class="cm">,</span>
            <span class="s">]</span><span class="cm">,</span>
        <span class="s">}</span><span class="cm">,</span>
    <span class="s">)</span><span class="sc">;</span></pre>
<p>Produces:</p>
<div class="verbatim"><ol><li>    par:</li><li>      seq:</li><li>        par:</li><li>          seq:</li><li>            par:</li><li>              seq:</li><li>                't/startup/foo.t'</li><li>            par:</li><li>              seq:</li><li>                't/a/foo.t'</li><li>              seq:</li><li>                't/b/foo.t'</li><li>              seq:</li><li>                't/c/foo.t'</li><li>            par:</li><li>              seq:</li><li>                't/shutdown/foo.t'</li><li>        't/d/foo.t'</li></ol></div>



      <ul><li><a href="#NAME">NAME</a></li><li><a href="#VERSION">VERSION</a></li><li><a href="#SYNOPSIS">SYNOPSIS</a></li><li><a href="#DESCRIPTION">DESCRIPTION</a></li><li><a href="#METHODS">METHODS</a></li><ul><li><a href="#Class-Methods">Class Methods</a></li><li><a href="#Rules-data-structure">Rules data structure</a></li><li><a href="#Instance-Methods">Instance Methods</a></li></ul></ul>


                </div>
              </article>
          </div>
        </div>
      </main>
    </div>
    <footer class="footer row bg-light pt-5 pb-5">
      <div class="col-sm-8 offset-sm-2">
        <div class="row">
          <div class="col-md-4">
            <ul class="list-unstyled">
              <li>
                <h4>Site info</h4>
              </li>
              <li>Docs mantained by
                <a href="//lists.cpan.org/showlist.cgi?name=perl5-porters" rel="noopener">Perl 5 Porters</a>
              </li>
              <li>Site development sponsored by
                <a href="//opusvl.com" rel="noopener"><img class="opus-logo" src="/public/img/opusvl_logo.svg" alt="OpusVL Logo"></a>
              </li>
            </ul>
          </div>
          <div class="col-md-8">
            <div class="row">
              <div class="col-md-6 col-lg-3">
                <ul class=" list-unstyled">
                  <li>
                    <h4>Manual</h4>
                  </li>
                  <li>
                    <a href="/5/28/1/index-overview.html">Overview</a>
                  </li>
                  <li>
                    <a href="/5/28/1/index-tutorials.html">Tutorials</a>
                  </li>
                  <li>
                    <a href="/5/28/1/index-faq.html">FAQs</a>
                  </li>
                  <li>
                    <a href="/5/28/1/index-history.html">Changes</a>
                  </li>
                </ul>
              </div>
              <div class="col-md-6 col-lg-3">
                <ul class=" list-unstyled">
                  <li>
                    <h4>Reference</h4>
                  </li>
                  <li>
                    <a href="/5/28/1/index-language.html">Language</a>
                  </li>
                  <li>
                    <a href="/5/28/1/index-functions.html">Functions</a>
                  </li>
                  <li>
                    <a href="/5/28/1/perlop.html">Operators</a>
                  </li>
                  <li>
                    <a href="/5/28/1/perlvar.html">Variables</a>
                  </li>
                </ul>
              </div>
              <div class="col-md-6 col-lg-3">
                <ul class=" list-unstyled">
                  <li>
                    <h4>Modules</h4>
                  </li>
                  <li>
                    <a href="/5/28/1/index-modules-A.html">Modules</a>
                  </li>
                  <li>
                    <a href="/5/28/1/index-pragmas.html">Pragmas</a>
                  </li>
                  <li>
                    <a href="/5/28/1/index-utilities.html">Utilities</a>
                  </li>
                </ul>
              </div>
              <div class="col-md-6 col-lg-3">
                <ul class=" list-unstyled">
                  <li>
                    <h4>Misc</h4>
                  </li>
                  <li>
                    <a href="/5/28/1/index-licence.html">License</a>
                  </li>
                  <li>
                    <a href="/5/28/1/index-internals.html">Internals</a>
                  </li>
                  <li>
                    <a href="/5/28/1/index-platforms.html">Platforms</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class=" col-12 footer-inf text-center">
            <small>perldoc.perl.org - Official documentation for the Perl programming language</small>
          </div>
        </div>
      </div>
    </footer>
    <div class="beta-wrapper beta-bottom-right ">
      <div class="beta beta-blue  ">
        <a class="beta-link " href="https://github.com/OpusVL/perldoc.perl.org/issues/new" rel="noopener">
          <span class="beta-text">
            This is a Beta release.
          </span>
          <span class="beta-text">
            For any issues please raise a ticket on GitHub
          </span>
        </a>
      </div>
    </div>
    <script src="/public/js/main.min.js"></script>
  </body>
</html>
