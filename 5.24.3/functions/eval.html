<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="eval - perldoc.perl.org">
    <link rel="icon" href="/public/img/favicon.ico">
    <title>eval - perldoc.perl.org</title>
    <link href="/public/css/main.min.css" rel="stylesheet">
    <link href='https://fonts.googleapis.com/css?family=Lato:400,100,300,700,900' rel='stylesheet' type='text/css'>
    <script>
            window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
            ga('create', 'UA-1892152-2', 'auto');  // JJ's account
            ga('create', 'UA-50555-3', 'auto', 'perlOrg');   // perl.org account
            ga('require', 'outboundLinkTracker', {
              events: ['click', 'auxclick', 'contextmenu'],
            });
            ga('require', 'maxScrollTracker');
            ga('send', 'pageview');
            ga('perlOrg.send', 'pageview');
    </script>
    <script async src="https://www.google-analytics.com/analytics.js"></script>
    <script async src="/public/js/tracking.min.js"></script>
  </head>
  <body class="body container-fluid ">
    <div class="wrapper">
        <nav class="navbar navbar-expand-md navbar-dark bg-primary bg-perl fixed-top justify-content-between">
          <a class="navbar-brand" href="/">
            <object class="logo" data="/public/img/logo_perl_doc.svg" type="image/svg+xml" name="Perl Documentation Logo">Perl Documentation Logo</object>
          </a>
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div id="navbar" class="collapse navbar-collapse justify-content-end">
            <ul class="nav navbar-nav navbar-right">
              <li class="nav-item dropdown">
                <a id="navbarDropdown" href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Perl versions</a>
                <div class="dropdown-menu" id="dropdown-menu-links" aria-labelledby="navbarDropdown">
                </div>
              </li>
              <li class="nav-item dropdown">
                <a id="navbarDropdown1" href="#" class="dropdown-toggle nav-link" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Manuals</a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown1">
                  <a class="dropdown-item" href="/5.24.3/index-overview.html">Overview</a>
                  <a class="dropdown-item" href="/5.24.3/index-tutorials.html">Tutorials</a>
                  <a class="dropdown-item" href="/5.24.3/index-faq.html">FAQs</a>
                  <a class="dropdown-item" href="/5.24.3/index-history.html">History / Changes</a>
                  <a class="dropdown-item" href="/5.24.3/index-licence.html">License</a>
                  <a class="dropdown-item" href="/5.24.3/index-language.html">Language</a>
                  <a class="dropdown-item" href="/5.24.3/index-functions.html">Functions</a>
                  <a class="dropdown-item" href="/5.24.3/perlop.html">Operators</a>
                  <a class="dropdown-item" href="/5.24.3/perlvar.html">Special Variables</a>
                  <a class="dropdown-item" href="/5.24.3/index-pragmas.html">Pragmas</a>
                  <a class="dropdown-item" href="/5.24.3/index-utilities.html">Utilities</a>
                  <a class="dropdown-item" href="/5.24.3/index-internals.html">Internals</a>
                  <a class="dropdown-item" href="/5.24.3/index-platforms.html">Platform Specific</a>
                </div>
              </li>
              <li class="nav-item dropdown">
                <a id="navbarDropdown3" href="#" class="nav-link dropdown-toggle " data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Modules</a>
                <div aria-labelledby="navbarDropdown3" class="dropdown-menu letters-wrap">
                  <a class="dropdown-item" href="/5.24.3/index-functions.html">A-Z</a>
                  <a class="dropdown-item" href="/5.24.3/index-functions-by-cat.html">By Category</a>
                  <div class="dropdown-divider"></div>
                  <div class="letter-container">
                    <a class="dropdown-item letters" href="/5.24.3/index-modules-A.html">A</a>
                    <a class="dropdown-item letters" href="/5.24.3/index-modules-B.html">B</a>
                    <a class="dropdown-item letters" href="/5.24.3/index-modules-C.html">C</a>
                    <a class="dropdown-item letters" href="/5.24.3/index-modules-D.html">D</a>
                    <a class="dropdown-item letters" href="/5.24.3/index-modules-E.html">E</a>
                    <a class="dropdown-item letters" href="/5.24.3/index-modules-F.html">F</a>
                    <a class="dropdown-item letters" href="/5.24.3/index-modules-G.html">G</a>
                    <a class="dropdown-item letters" href="/5.24.3/index-modules-H.html">H</a>
                    <a class="dropdown-item letters" href="/5.24.3/index-modules-I.html">I</a>
                    <a class="dropdown-item letters" href="/5.24.3/index-modules-J.html">J</a>
                    <a class="dropdown-item letters" href="/5.24.3/index-modules-L.html">L</a>
                    <a class="dropdown-item letters" href="/5.24.3/index-modules-M.html">M</a>
                    <a class="dropdown-item letters" href="/5.24.3/index-modules-N.html">N</a>
                    <a class="dropdown-item letters" href="/5.24.3/index-modules-O.html">O</a>
                    <a class="dropdown-item letters" href="/5.24.3/index-modules-P.html">P</a>
                    <a class="dropdown-item letters" href="/5.24.3/index-modules-S.html">S</a>
                    <a class="dropdown-item letters" href="/5.24.3/index-modules-T.html">T</a>
                    <a class="dropdown-item letters" href="/5.24.3/index-modules-U.html">U</a>
                    <a class="dropdown-item letters" href="/5.24.3/index-modules-X.html">X</a>
                    </div>
                </div>
              </li>
            </ul>
          </div>
          <!--/.nav-collapse -->
        </nav>

      <main class="row main-content pb-5 pt-5">
        <div class="col-sm-8 offset-sm-2">
          <div class="row">
            <div class="col-sm-12">
                <div id="breadcrumbs">
                    
    <a href="../index.html">Home</a>&nbsp; &gt;
    
      
        <a href="../index-language.html">Language reference</a> &gt;
      
        <a href="../index-functions.html">Functions</a> &gt;
      
    
    eval
  

                </div>
            </div>
          </div>
          <div class="row">
              <article class="col-sm-12 content">
                <div class="documentation-wrapper">
                  <div id="perl_version">
                    <h1 class='page-title'> Perl 5 version 24.3 documentation</h1>
                  </div>
                  <h1>eval</h1>
<div class="mod_az_list">
  <a href="/5.24.3/index-functions.html">Perl functions A-Z</a> |
  <a href="/5.24.3/index-functions-by-cat.html">Perl functions by category</a> |
  <a href="/5.24.3/perlfunc.html">The 'perlfunc' manpage</a>
</div>


  <!--    -->
<ul>
<li><a id="eval-EXPR"></a><strong>eval EXPR</strong>
<p>     
 </p>
</li>
</ul>
<ul>
<li><a id="eval-BLOCK"></a><strong>eval BLOCK</strong>
</li>
<li><a id="eval"></a><strong>eval</strong>
<p>In the first form, often referred to as a "string eval", the return
value of EXPR is parsed and executed as if it
were a little Perl program.  The value of the expression (which is itself
determined within scalar context) is first parsed, and if there were no
errors, executed as a block within the lexical context of the current Perl
program.  This means, that in particular, any outer lexical variables are
visible to it, and any package variable settings or subroutine and format
definitions remain afterwards.</p>
<p>Note that the value is parsed every time the <a href="#eval-EXPR">eval</a>
executes.  If EXPR is omitted, evaluates <a href="../perlvar.html#%24_"> $_ </a>.  This form
is typically used to delay parsing and subsequent execution of the text
of EXPR until run time.</p>
<p>If the
<a href="../feature.html#The-'unicode_eval'-and-'evalbytes'-features"> unicode_eval feature</a>
is enabled (which is the default under a
<pre>
<a class="l_k" href="../functions/use.html">use</a> <span class="n">5.16</span></code>
 or higher declaration), EXPR or <a href="../perlvar.html#%24_"> $_ </a> is
treated as a string of characters, so <a href="../utf8.html"> use utf8 </a> declarations
have no effect, and source filters are forbidden.  In the absence of the
<a href="../feature.html#The-'unicode_eval'-and-'evalbytes'-features"> unicode_eval feature</a>,
will sometimes be treated as characters and sometimes as bytes,
depending on the internal encoding, and source filters activated within
the <a href="#eval-EXPR">eval</a> exhibit the erratic, but historical, behaviour
of affecting some outer file scope that is still compiling.  See also
the <a href="#evalbytes-EXPR">evalbytes</a> operator, which always treats its
input as a byte stream and works properly with source filters, and the
<a href="../feature.html">feature</a> pragma.</p>
<p>Problems can arise if the string expands a scalar containing a floating
point number.  That scalar can expand to letters, such as <pre>
<span class="q">&quot;NaN&quot;</span></code>
 or
<pre>
<span class="q">&quot;Infinity&quot;</span></code>
; or, within the scope of a <a href="../locale.html"> use locale </a>, the
decimal point character may be something other than a dot (such as a
comma).  None of these are likely to parse as you are likely expecting.</p>
<p>In the second form, the code within the BLOCK is parsed only once--at the
same time the code surrounding the <a href="#eval-EXPR">eval</a> itself was
parsed--and executed
within the context of the current Perl program.  This form is typically
used to trap exceptions more efficiently than the first (see below), while
also providing the benefit of checking the code within BLOCK at compile
time.</p>
<p>The final semicolon, if any, may be omitted from the value of EXPR or within
the BLOCK.</p>
<p>In both forms, the value returned is the value of the last expression
evaluated inside the mini-program; a return statement may be also used, just
as with subroutines.  The expression providing the return value is evaluated
in void, scalar, or list context, depending on the context of the
<a href="#eval-EXPR">eval</a> itself.  See <a href="../functions/wantarray.html">wantarray</a> for more
on how the evaluation context can be determined.</p>
<p>If there is a syntax error or runtime error, or a <a href="#die-LIST">die</a>
statement is executed, <a href="#eval-EXPR">eval</a> returns
<a href="#undef-EXPR">undef</a> in scalar context or an empty list in list
context, and <a href="../perlvar.html#%24%40"> $@ </a> is set to the error message.  (Prior to
5.16, a bug caused <a href="#undef-EXPR">undef</a> to be returned in list
context for syntax errors, but not for runtime errors.) If there was no
error, <a href="../perlvar.html#%24%40"> $@ </a> is set to the empty string.  A control flow
operator like <a href="#last-LABEL">last</a> or <a href="#goto-LABEL">goto</a> can
bypass the setting of <a href="../perlvar.html#%24%40"> $@ </a>.  Beware that using
<a href="#eval-EXPR">eval</a> neither silences Perl from printing warnings to
STDERR, nor does it stuff the text of warning messages into
<a href="../perlvar.html#%24%40"> $@ </a>.  To do either of those, you have to use the
<a href="../perlvar.html#%25SIG"> $SIG{__WARN__} </a> facility, or turn off warnings inside
the BLOCK or EXPR using <pre>
<a class="l_k" href="../functions/no.html">no</a> <span class="w">warnings</span> <span class="q">&#39;all&#39;</span></code>
.  See
<a href="#warn-LIST">warn</a>, <a href="../perlvar.html">perlvar</a>, and <a href="../warnings.html">warnings</a>.</p>
<p>Note that, because <a href="#eval-EXPR">eval</a> traps otherwise-fatal errors,
it is useful for determining whether a particular feature (such as
<a href="#socket-SOCKET%2cDOMAIN%2cTYPE%2cPROTOCOL">socket</a> or
<a href="#symlink-OLDFILE%2cNEWFILE">symlink</a>) is implemented.  It is also
Perl's exception-trapping mechanism, where the <a href="#die-LIST">die</a>
operator is used to raise exceptions.</p>
<p>If you want to trap errors when loading an XS module, some problems with
the binary interface (such as Perl version skew) may be fatal even with
<a href="#eval-EXPR">eval</a> unless <pre>
<span class="i">$ENV</span>{<span class="w">PERL_DL_NONLAZY</span>}</code>
 is set.  See
<a href="../perlrun.html">perlrun</a>.</p>
<p>If the code to be executed doesn't vary, you may use the eval-BLOCK
form to trap run-time errors without incurring the penalty of
recompiling each time.  The error, if any, is still returned in
<a href="../perlvar.html#%24%40"> $@ </a>.
Examples:</p>
<pre>
    <span class="c"># make divide-by-zero nonfatal</span>
    <a class="l_k" href="../functions/eval.html">eval</a> <span class="s">{</span> <span class="i">$answer</span> = <span class="i">$a</span> / <span class="i">$b</span><span class="sc">;</span> <span class="s">}</span><span class="sc">;</span> <a class="l_k" href="../functions/warn.html">warn</a> <span class="i">$@</span> <a class="l_k" href="../functions/if.html">if</a> <span class="i">$@</span><span class="sc">;</span>

    <span class="c"># same thing, but less efficient</span>
    <a class="l_k" href="../functions/eval.html">eval</a> <span class="q">&#39;$answer = $a / $b&#39;</span><span class="sc">;</span> <a class="l_k" href="../functions/warn.html">warn</a> <span class="i">$@</span> <a class="l_k" href="../functions/if.html">if</a> <span class="i">$@</span><span class="sc">;</span>

    <span class="c"># a compile-time error</span>
    <a class="l_k" href="../functions/eval.html">eval</a> <span class="s">{</span> <span class="i">$answer</span> = <span class="s">}</span><span class="sc">;</span> <span class="c"># WRONG</span>

    <span class="c"># a run-time error</span>
    <a class="l_k" href="../functions/eval.html">eval</a> <span class="q">&#39;$answer =&#39;</span><span class="sc">;</span>   <span class="c"># sets $@</span></pre>
<p>Using the <pre>
<a class="l_k" href="../functions/eval.html">eval</a> <span class="s">{</span><span class="s">}</span></code>
 form as an exception trap in libraries does have some
issues.  Due to the current arguably broken state of <pre>
<span class="w">__DIE__</span></code>
 hooks, you
may wish not to trigger any <pre>
<span class="w">__DIE__</span></code>
 hooks that user code may have installed.
You can use the <pre>
<a class="l_k" href="../functions/local.html">local</a> <span class="i">$SIG</span>{<span class="w">__DIE__</span>}</code>
 construct for this purpose,
as this example shows:</p>
<pre>
    <span class="c"># a private exception trap for divide-by-zero</span>
    <a class="l_k" href="../functions/eval.html">eval</a> <span class="s">{</span> <a class="l_k" href="../functions/local.html">local</a> <span class="i">$SIG</span>{<span class="q">&#39;__DIE__&#39;</span>}<span class="sc">;</span> <span class="i">$answer</span> = <span class="i">$a</span> / <span class="i">$b</span><span class="sc">;</span> <span class="s">}</span><span class="sc">;</span>
    <a class="l_k" href="../functions/warn.html">warn</a> <span class="i">$@</span> <a class="l_k" href="../functions/if.html">if</a> <span class="i">$@</span><span class="sc">;</span></pre>
<p>This is especially significant, given that <pre>
<span class="w">__DIE__</span></code>
 hooks can call
<a href="#die-LIST">die</a> again, which has the effect of changing their error
messages:</p>
<pre>
    <span class="c"># __DIE__ hooks may modify error messages</span>
    <span class="s">{</span>
       <a class="l_k" href="../functions/local.html">local</a> <span class="i">$SIG</span>{<span class="q">&#39;__DIE__&#39;</span>} =
              <a class="l_k" href="../functions/sub.html">sub</a> <span class="s">{</span> <span class="s">(</span><a class="l_k" href="../functions/my.html">my</a> <span class="i">$x</span> = <span class="i">$_</span>[<span class="n">0</span>]<span class="s">)</span> =~ <span class="q">s/foo/bar/g</span><span class="sc">;</span> <a class="l_k" href="../functions/die.html">die</a> <span class="i">$x</span> <span class="s">}</span><span class="sc">;</span>
       <a class="l_k" href="../functions/eval.html">eval</a> <span class="s">{</span> <a class="l_k" href="../functions/die.html">die</a> <span class="q">&quot;foo lives here&quot;</span> <span class="s">}</span><span class="sc">;</span>
       <a class="l_k" href="../functions/print.html">print</a> <span class="i">$@</span> <a class="l_k" href="../functions/if.html">if</a> <span class="i">$@</span><span class="sc">;</span>                <span class="c"># prints &quot;bar lives here&quot;</span>
    <span class="s">}</span></pre>
<p>Because this promotes action at a distance, this counterintuitive behavior
may be fixed in a future release.</p>
<p>With an <a href="#eval-EXPR">eval</a>, you should be especially careful to
remember what's being looked at when:</p>
<pre>
    <a class="l_k" href="../functions/eval.html">eval</a> <span class="i">$x</span><span class="sc">;</span>        <span class="c"># CASE 1</span>
    <a class="l_k" href="../functions/eval.html">eval</a> <span class="q">&quot;$x&quot;</span><span class="sc">;</span>      <span class="c"># CASE 2</span>

    <a class="l_k" href="../functions/eval.html">eval</a> <span class="q">&#39;$x&#39;</span><span class="sc">;</span>      <span class="c"># CASE 3</span>
    <a class="l_k" href="../functions/eval.html">eval</a> <span class="s">{</span> <span class="i">$x</span> <span class="s">}</span><span class="sc">;</span>    <span class="c"># CASE 4</span>

    <a class="l_k" href="../functions/eval.html">eval</a> <span class="q">&quot;\$$x++&quot;</span><span class="sc">;</span>  <span class="c"># CASE 5</span>
    <span class="i">$$x</span>++<span class="sc">;</span>          <span class="c"># CASE 6</span></pre>
<p>Cases 1 and 2 above behave identically: they run the code contained in
the variable $x.  (Although case 2 has misleading double quotes making
the reader wonder what else might be happening (nothing is).)  Cases 3
and 4 likewise behave in the same way: they run the code <pre>
<span class="q">&#39;$x&#39;</span></code>
, which
does nothing but return the value of $x.  (Case 4 is preferred for
purely visual reasons, but it also has the advantage of compiling at
compile-time instead of at run-time.)  Case 5 is a place where
normally you <i>would</i> like to use double quotes, except that in this
particular situation, you can just use symbolic references instead, as
in case 6.</p>
<p>Before Perl 5.14, the assignment to <a href="../perlvar.html#%24%40"> $@ </a> occurred before
restoration
of localized variables, which means that for your code to run on older
versions, a temporary is required if you want to mask some but not all
errors:</p>
<pre>
    <span class="c"># alter $@ on nefarious repugnancy only</span>
    <span class="s">{</span>
       <a class="l_k" href="../functions/my.html">my</a> <span class="i">$e</span><span class="sc">;</span>
       <span class="s">{</span>
         <a class="l_k" href="../functions/local.html">local</a> <span class="i">$@</span><span class="sc">;</span> <span class="c"># protect existing $@</span>
         <a class="l_k" href="../functions/eval.html">eval</a> <span class="s">{</span> <span class="i">test_repugnancy</span><span class="s">(</span><span class="s">)</span> <span class="s">}</span><span class="sc">;</span>
         <span class="c"># $@ =~ /nefarious/ and die $@; # Perl 5.14 and higher only</span>
         <span class="i">$@</span> =~ <span class="q">/nefarious/</span> <a class="l_k" href="../functions/and.html">and</a> <span class="i">$e</span> = <span class="i">$@</span><span class="sc">;</span>
       <span class="s">}</span>
       <a class="l_k" href="../functions/die.html">die</a> <span class="i">$e</span> <a class="l_k" href="../functions/if.html">if</a> <a class="l_k" href="../functions/defined.html">defined</a> <span class="i">$e</span>
    <span class="s">}</span></pre>
<p><pre>
<a class="l_k" href="../functions/eval.html">eval</a> <span class="w">BLOCK</span></code>
 does <i>not</i> count as a loop, so the loop control statements
<a href="#next-LABEL">next</a>, <a href="#last-LABEL">last</a>, or
<a href="#redo-LABEL">redo</a> cannot be used to leave or restart the block.</p>
<p>An <pre>
<a class="l_k" href="../functions/eval.html">eval</a> <span class="q">&#39;&#39;</span></code>
 executed within a subroutine defined
in the <pre>
<span class="w">DB</span></code>
 package doesn't see the usual
surrounding lexical scope, but rather the scope of the first non-DB piece
of code that called it.  You don't normally need to worry about this unless
you are writing a Perl debugger.</p>
</li>
</ul>



                </div>
              </article>
          </div>
        </div>
      </main>
    </div>
    <footer class="footer row bg-light pt-5 pb-5">
      <div class="col-sm-8 offset-sm-2">
        <div class="row">
          <div class="col-md-4">
            <ul class="list-unstyled">
              <li>
                <h4>Site info</h4>
              </li>
              <li>Docs mantained by
                <a href="//lists.cpan.org/showlist.cgi?name=perl5-porters" rel="noopener">Perl 5 Porters</a>
              </li>
              <li>Site development sponsored by
                <a href="//opusvl.com" rel="noopener"><img class="opus-logo" src="/public/img/opusvl_logo.svg" alt="OpusVL Logo"></a>
              </li>
            </ul>
          </div>
          <div class="col-md-8">
            <div class="row">
              <div class="col-md-6 col-lg-3">
                <ul class=" list-unstyled">
                  <li>
                    <h4>Manual</h4>
                  </li>
                  <li>
                    <a href="/5/24/3/index-overview.html">Overview</a>
                  </li>
                  <li>
                    <a href="/5/24/3/index-tutorials.html">Tutorials</a>
                  </li>
                  <li>
                    <a href="/5/24/3/index-faq.html">FAQs</a>
                  </li>
                  <li>
                    <a href="/5/24/3/index-history.html">Changes</a>
                  </li>
                </ul>
              </div>
              <div class="col-md-6 col-lg-3">
                <ul class=" list-unstyled">
                  <li>
                    <h4>Reference</h4>
                  </li>
                  <li>
                    <a href="/5/24/3/index-language.html">Language</a>
                  </li>
                  <li>
                    <a href="/5/24/3/index-functions.html">Functions</a>
                  </li>
                  <li>
                    <a href="/5/24/3/perlop.html">Operators</a>
                  </li>
                  <li>
                    <a href="/5/24/3/perlvar.html">Variables</a>
                  </li>
                </ul>
              </div>
              <div class="col-md-6 col-lg-3">
                <ul class=" list-unstyled">
                  <li>
                    <h4>Modules</h4>
                  </li>
                  <li>
                    <a href="/5/24/3/index-modules-A.html">Modules</a>
                  </li>
                  <li>
                    <a href="/5/24/3/index-pragmas.html">Pragmas</a>
                  </li>
                  <li>
                    <a href="/5/24/3/index-utilities.html">Utilities</a>
                  </li>
                </ul>
              </div>
              <div class="col-md-6 col-lg-3">
                <ul class=" list-unstyled">
                  <li>
                    <h4>Misc</h4>
                  </li>
                  <li>
                    <a href="/5/24/3/index-licence.html">License</a>
                  </li>
                  <li>
                    <a href="/5/24/3/index-internals.html">Internals</a>
                  </li>
                  <li>
                    <a href="/5/24/3/index-platforms.html">Platforms</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class=" col-12 footer-inf text-center">
            <small>perldoc.perl.org - Official documentation for the Perl programming language</small>
          </div>
        </div>
      </div>
    </footer>
    <div class="beta-wrapper beta-bottom-right ">
      <div class="beta beta-blue  ">
        <a class="beta-link " href="https://github.com/OpusVL/perldoc.perl.org/issues/new" rel="noopener">
          <span class="beta-text">
            This is a Beta release.
          </span>
          <span class="beta-text">
            For any issues please raise a ticket on GitHub
          </span>
        </a>
      </div>
    </div>
    <script src="/public/js/main.min.js"></script>
  </body>
</html>
